sudo: required

language: ruby

services:
  - docker

before_install:
- mkdir -p themes && rm -rf themes/*
- git clone https://github.com/tapanchandra/hugo-theme-m10x themes/m10x
- rm -rf themes/m10x/.git
- mkdir -p docs && rm -rf docs/*

script:
- docker run --name "my-blog" -P -v $(pwd):/src --volume /tmp/hugo-build-output:/docs jojomi/hugo

deploy:
  provider: pages
  skip-cleanup: true
  github-token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
  keep-history: true
  on:
    branch: master